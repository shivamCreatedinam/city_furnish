{"version":3,"sources":["FBAppEventsLogger.ts"],"names":["AppEventsLogger","NativeModules","FBAppEventsLogger","AppEvents","AppEventParams","getConstants","setFlushBehavior","flushBehavior","logEvent","eventName","valueToSum","args","Number","shift","parameters","logPurchase","purchaseAmount","currencyCode","logPushNotificationOpen","payload","logProductItem","itemID","availability","condition","description","imageLink","link","title","priceAmount","currency","gtin","mpn","brand","Error","flush","setUserID","userID","Platform","OS","clearUserID","getUserID","getAnonymousID","getAdvertiserID","getAttributionID","setUserData","userData","setPushNotificationsDeviceToken","deviceToken","setPushNotificationsRegistrationId","registrationId"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.\n *\n * You are hereby granted a non-exclusive, worldwide, royalty-free license to use,\n * copy, modify, and distribute this software in source code or binary form for use\n * in connection with the web services and APIs provided by Facebook.\n *\n * As with any software that integrates with the Facebook platform, your use of\n * this software is subject to the Facebook Developer Principles and Policies\n * [http://developers.facebook.com/policy/]. This copyright notice shall be\n * included in all copies or substantial portions of the software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * @format\n */\nimport {isDefined, isNumber, isOneOf, isString} from './util/validate';\nimport {NativeModules} from 'react-native';\nimport {Platform} from 'react-native';\n\nconst AppEventsLogger = NativeModules.FBAppEventsLogger;\n\n/**\n * Controls when an AppEventsLogger sends log events to the server\n */\nexport type AppEventsFlushBehavior =\n  /**\n   * Flush automatically: periodically (every 15 seconds or after every 100 events), and\n   * always at app reactivation. This is the default value.\n   */\n  | 'auto'\n  /**\n   * Only flush when AppEventsLogger.flush() is explicitly invoked.\n   */\n  | 'explicit_only';\n\n/**\n * Specifies product availability for Product Catalog product item update\n */\nexport type ProductAvailability =\n  /**\n   * Item ships immediately\n   */\n  | 'in_stock'\n  /**\n   * No plan to restock\n   */\n  | 'out_of_stock'\n  /**\n   * Available in future\n   */\n  | 'preorder'\n  /**\n   * Ships in 1-2 weeks\n   */\n  | 'avaliable_for_order'\n  /**\n   * Discontinued\n   */\n  | 'discontinued';\n\n/**\n * Specifies product condition for Product Catalog product item update\n */\nexport type ProductCondition = 'new' | 'refurbished' | 'used';\n\nexport type Params = {[key: string]: string | number};\n\n/**\n * Info about a user to increase chances of matching a Facebook user.\n * See https://developers.facebook.com/docs/app-events/advanced-matching for\n * more info about the expected format of each field.\n */\nexport type UserData = Readonly<{\n  email?: string;\n  firstName?: string;\n  lastName?: string;\n  phone?: string;\n  dateOfBirth?: string;\n  gender?: 'm' | 'f';\n  city?: string;\n  state?: string;\n  zip?: string;\n  country?: string;\n}>;\n\nexport type AppEvent = {\n  AchievedLevel: string;\n  AdClick: string;\n  AdImpression: string;\n  AddedPaymentInfo: string;\n  AddedToCart: string;\n  AddedToWishlist: string;\n  CompletedRegistration: string;\n  CompletedTutorial: string;\n  Contact: string;\n  CustomizeProduct: string;\n  Donate: string;\n  FindLocation: string;\n  InitiatedCheckout: string;\n  Purchased: string;\n  Rated: string;\n  Searched: string;\n  SpentCredits: string;\n  Schedule: string;\n  StartTrial: string;\n  SubmitApplication: string;\n  Subscribe: string;\n  UnlockedAchievement: string;\n  ViewedContent: string;\n};\n\nexport type AppEventParam = {\n  AddType: string;\n  Content: string;\n  ContentID: string;\n  ContentType: string;\n  Currency: string;\n  Description: string;\n  Level: string;\n  NumItems: string;\n  MaxRatingValue: string;\n  OrderId: string;\n  PaymentInfoAvailable: string;\n  RegistrationMethod: string;\n  SearchString: string;\n  Success: string;\n  ValueNo: string;\n  ValueYes: string;\n};\n\nconst {AppEvents, AppEventParams} = AppEventsLogger?.getConstants() || {};\n\nexport default {\n  /**\n   * Sets the current event flushing behavior specifying when events\n   * are sent back to Facebook servers.\n   */\n  setFlushBehavior(flushBehavior: AppEventsFlushBehavior) {\n    AppEventsLogger.setFlushBehavior(flushBehavior);\n  },\n\n  /**\n   * Logs an event with eventName and optional arguments.\n   * This function supports the following usage:\n   * logEvent(eventName: string);\n   * logEvent(eventName: string, valueToSum: number);\n   * logEvent(eventName: string, parameters: {[key:string]:string|number});\n   * logEvent(eventName: string, valueToSum: number, parameters: {[key:string]:string|number});\n   * See https://developers.facebook.com/docs/app-events/android for detail.\n   */\n  logEvent(eventName: string, ...args: Array<number | Params>) {\n    let valueToSum = 0;\n    if (typeof args[0] === 'number') {\n      valueToSum = Number(args.shift());\n    }\n    let parameters = null;\n    if (typeof args[0] === 'object') {\n      parameters = args[0];\n    }\n    AppEventsLogger.logEvent(eventName, valueToSum, parameters);\n  },\n\n  /**\n   * Logs a purchase. See http://en.wikipedia.org/wiki/ISO_4217 for currencyCode.\n   */\n  logPurchase(\n    purchaseAmount: number,\n    currencyCode: string,\n    parameters?: Params,\n  ) {\n    AppEventsLogger.logPurchase(purchaseAmount, currencyCode, parameters);\n  },\n\n  /**\n   * Logs an app event that tracks that the application was open via Push Notification.\n   */\n  logPushNotificationOpen(payload?: Record<string, string | number>) {\n    AppEventsLogger.logPushNotificationOpen(payload);\n  },\n\n  /**\n   * Uploads product catalog product item as an app event\n   * @param itemID – Unique ID for the item. Can be a variant for a product. Max size is 100.\n   * @param availability – If item is in stock. Accepted values are: in stock - Item ships immediately out of stock - No plan to restock preorder - Available in future available for order - Ships in 1-2 weeks discontinued - Discontinued\n   * @param condition – Product condition: new, refurbished or used.\n   * @param description – Short text describing product. Max size is 5000.\n   * @param imageLink – Link to item image used in ad.\n   * @param link – Link to merchant's site where someone can buy the item.\n   * @param title – Title of item.\n   * @param priceAmount – Amount of purchase, in the currency specified by the 'currency' parameter. This value will be rounded to the thousandths place (e.g., 12.34567 becomes 12.346).\n   * @param currency – Currency used to specify the amount.\n   * @param gtin – Global Trade Item Number including UPC, EAN, JAN and ISBN\n   * @param mpn – Unique manufacture ID for product\n   * @param brand – Name of the brand Note: Either gtin, mpn or brand is required.\n   * @param parameters – Optional fields for deep link specification.\n   */\n  logProductItem(\n    itemID: string,\n    availability: ProductAvailability,\n    condition: ProductCondition,\n    description: string,\n    imageLink: string,\n    link: string,\n    title: string,\n    priceAmount: number,\n    currency: string,\n    gtin?: string,\n    mpn?: string,\n    brand?: string,\n    parameters?: Params,\n  ) {\n    if (!isDefined(itemID) || !isString(itemID)) {\n      throw new Error(\"logProductItem expected 'itemID' to be a string\");\n    }\n    if (\n      !isDefined(availability) ||\n      !isOneOf(availability, [\n        'in_stock',\n        'out_of_stock',\n        'preorder',\n        'avaliable_for_order',\n        'discontinued',\n      ])\n    ) {\n      throw new Error(\n        \"logProductItem expected 'availability' to be one of 'in_stock' | 'out_of_stock' | 'preorder' | 'avaliable_for_order' | 'discontinued'\",\n      );\n    }\n    if (\n      !isDefined(condition) ||\n      !isOneOf(condition, ['new', 'refurbished', 'used'])\n    ) {\n      throw new Error(\n        \"logProductItem expected 'condition' to be one of 'new' | 'refurbished' | 'used'\",\n      );\n    }\n    if (!isDefined(description) || !isString(description)) {\n      throw new Error(\"logProductItem expected 'description' to be a string\");\n    }\n    if (!isDefined(imageLink) || !isString(imageLink)) {\n      throw new Error(\"logProductItem expected 'imageLink' to be a string\");\n    }\n    if (!isDefined(link) || !isString(link)) {\n      throw new Error(\"logProductItem expected 'link' to be a string\");\n    }\n    if (!isDefined(title) || !isString(title)) {\n      throw new Error(\"logProductItem expected 'title' to be a string\");\n    }\n    if (!isDefined(priceAmount) || !isNumber(priceAmount)) {\n      throw new Error(\"logProductItem expected 'priceAmount' to be a number\");\n    }\n    if (!isDefined(currency) || !isString(currency)) {\n      throw new Error(\"logProductItem expected 'currency' to be a string\");\n    }\n    if (!isDefined(gtin) && !isDefined(mpn) && !isDefined(brand)) {\n      throw new Error(\n        'logProductItem expected either gtin, mpn or brand to be defined',\n      );\n    }\n\n    AppEventsLogger.logProductItem(\n      itemID,\n      availability,\n      condition,\n      description,\n      imageLink,\n      link,\n      title,\n      priceAmount,\n      currency,\n      gtin,\n      mpn,\n      brand,\n      parameters,\n    );\n  },\n\n  /**\n   * Explicitly kicks off flushing of events to Facebook.\n   */\n  flush() {\n    AppEventsLogger.flush();\n  },\n\n  /**\n   * Sets a custom user ID to associate with all app events.\n   * The userID is persisted until this method is called again with a null userId\n   */\n  setUserID(userID: string | null) {\n    if (userID === null && Platform.OS === 'android') {\n      // TODO: Remove workaround once https://github.com/facebook/facebook-android-sdk/issues/1047 is released\n      AppEventsLogger.clearUserID();\n      return;\n    }\n    AppEventsLogger.setUserID(userID);\n  },\n\n  /**\n   * Clears the currently set user id.\n   * @deprecated use setUserID(null) instead\n   */\n  clearUserID() {\n    AppEventsLogger.clearUserID();\n  },\n\n  /**\n   * Returns user id or null if not set\n   */\n  async getUserID(): Promise<string | null> {\n    return await AppEventsLogger.getUserID();\n  },\n\n  /**\n   * Returns anonymous id or null if not set\n   */\n  async getAnonymousID(): Promise<string | null> {\n    return await AppEventsLogger.getAnonymousID();\n  },\n\n  /**\n   * Returns advertiser id or null if not set\n   */\n  async getAdvertiserID(): Promise<string | null> {\n    return await AppEventsLogger.getAdvertiserID();\n  },\n\n  /**\n   * Returns advertiser id or null if not set.\n   * @platform android\n   */\n  async getAttributionID(): Promise<string | null> {\n    if (Platform.OS === 'ios') {\n      return null;\n    }\n    return await AppEventsLogger.getAttributionID();\n  },\n\n  /**\n   * Set additional data about the user to increase chances of matching a Facebook user.\n   */\n  setUserData(userData: UserData) {\n    AppEventsLogger.setUserData(userData);\n  },\n\n  /**\n   * For iOS only, sets and sends device token to register the current application for push notifications.\n   * @platform ios\n   */\n  setPushNotificationsDeviceToken(deviceToken: string) {\n    AppEventsLogger.setPushNotificationsDeviceToken(deviceToken);\n  },\n\n  /**\n   * For Android only, sets and sends registration id to register the current app for push notifications.\n   * @platform Android\n   */\n  setPushNotificationsRegistrationId(registrationId: string) {\n    AppEventsLogger.setPushNotificationsRegistrationId(registrationId);\n  },\n\n  /**\n   * Predefined event names for logging events common to many apps.\n   */\n  AppEvents,\n\n  /**\n   *  Predefined event name parameters for common additional information to accompany events logged through the `logEvent`.\n   */\n  AppEventParams,\n};\n"]}